# 任务调度

> crontab 进行定时任务的设置

* **基本用法**

  `crontab [选项]`

* **常用选项**

  `-e`：编辑crontab定时任务

  `-l`：打印crontab任务

  `-r`：删除当前用户的所有crontab任务

* 设置任务时5个占位符的说明

  `* * * * *`

  | 占位符 |        含义        |           范围            |
  | :----: | :----------------: | :-----------------------: |
  | 第一个 | 一小时中的第几分钟 |           0-59            |
  | 第二个 |  一天中的第几小时  |           0-23            |
  | 第三个 |  一个月中的第几日  |           1-31            |
  | 第四个 |   一年中的第几月   |           1-12            |
  | 第五个 |   一周中的星期几   | 0-7(**0和7都代表星期天**) |

* 特殊符号说明

  | 符号 | 含义                                                         |
  | :--: | ------------------------------------------------------------ |
  |  *   | 代表任何时间。比如第一个*就带表一小时中的每一分钟            |
  |  ,   | 代表不连续的时间。如"0 8,12 * * *"，表示每天的8点0分，12点0分 |
  |  -   | 表示连续的时间范围。如"0 5 * * 1-6"，表示每月的星期一至星期6的5点0分 |
  | */x  | 表示每隔多久执行一次。如"*/1 * * * *"，表示每隔1分钟执行一次 |

  

* 特定时间案例

  |     时间     | 含义                                      |
  | :----------: | ----------------------------------------- |
  | 45 22 * * *  | 每天的22点45分执行                        |
  |  0 17 * * 1  | 每周一的17短板0分执行                     |
  | 0 5 1,15 * * | 每月的1号和15号的5点0分执行               |
  | 40 4 * * 1-5 | 周一到周五的4点40执行                     |
  | 0 0 1,15 * 1 | 每月1号和15号，每周1的0点0分执行          |
  | */10 4 * * * | 每天的凌晨4点开始，每隔10分钟执行一次命令 |

  

* 如果只是简单的任务，可以不用写脚本直接在crontab中写Linux指令即可，对于比较复杂的任务需要写脚本(Shell)

* **相关指令**

  * `crontab -r`：删除该用户的所有任务
  * `crontab -l`：打印所有任务
  * `service crond restart`：重启任务调度

* 快速入门案例**

  > 设置任务每隔1分钟执行`ls -l /etc >> /tmp/to.txt命令`

  1. `crontab -e`
  2. 输入`*/1 * * * * ls -l /etc >> /tmp/to.txt`

* **任务调度实例**

  > 每隔一分钟将当前的日期信息追加到/tmp/mydate文件

  1. 编写一个shell脚本`/home/task.sh`

     输入`date >> /tmp/mydate.txt`

  2. 将task.sh权限设置成可执行的（`x`）

     `chmod a+x ta sk.sh`

  3. `crontab -e`
  4. 输入`*/1 * * * * /home/task.sh`